{% extends "base.jinja" %}

{% set body_class = "flex flex-col min-h-screen bg-gray-100 dark:bg-gray-900 transition-colors duration-500" %}

{% block content %}
<nav class="w-full bg-white dark:bg-gray-800 px-6 py-3 flex justify-between items-center">
    <h1 class="text-lg font-semibold text-gray-700 dark:text-gray-200">Language Agnostic Chatbot</h1>
    <button id="toggleDark" class="text-gray-700 dark:text-gray-200 text-xl focus:outline-none">
        <i id="themeIcon" class="fas fa-moon"></i>
    </button>
</nav>
<main class="flex-grow flex items-center justify-center">
    <div class="w-full max-w-md bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-8 transition-colors duration-500">
        <div class="flex mb-6 border-b border-gray-200 dark:border-gray-700">
            <button id="loginTab"
                class="w-1/2 pb-2 text-center text-lg font-semibold border-b-2 focus:outline-none text-blue-600 border-blue-600">Login</button>
            <button id="registerTab"
                class="w-1/2 pb-2 text-center text-lg font-semibold border-b-2 border-transparent text-gray-500 dark:text-gray-400 hover:text-blue-600 focus:outline-none">Register</button>
        </div>
        <form id="loginForm" class="space-y-4 animate__animated animate__fadeIn" method="POST" action="{{ url_for('login_post') }}">
            {{ login_form.hidden_tag() }}
            <div>
                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300">Email</label>
                <input id="login-email" name="email" type="email" placeholder="Enter your email"
                    class="w-full mt-1 px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none dark:bg-gray-700 dark:border-gray-600 dark:text-white">
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300">Password</label>
                <input id="login-password" name="password" type="password" placeholder="Enter your password"
                    class="w-full mt-1 px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none dark:bg-gray-700 dark:border-gray-600 dark:text-white">
            </div>
            <button id="login-submit" type="submit" class="w-full py-2 mt-2 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 transition">Login</button>
        </form>

        <form id="registerForm" class="space-y-4 hidden animate__animated animate__fadeIn" method="POST" action="{{ url_for('register_post') }}">
            {{ register_form.hidden_tag() }}
            <div>
                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300">Full Name</label>
                <input id="register-name" name="register-name" type="text" placeholder="Enter your name"
                    class="w-full mt-1 px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none dark:bg-gray-700 dark:border-gray-600 dark:text-white">
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300">Email</label>
                <input id="register-email" name="register-email" type="email" placeholder="Enter your email"
                    class="w-full mt-1 px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none dark:bg-gray-700 dark:border-gray-600 dark:text-white">
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300">Password</label>
                <input id="register-password" name="register-password" type="password" placeholder="Create a password"
                    class="w-full mt-1 px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none dark:bg-gray-700 dark:border-gray-600 dark:text-white">
            </div>
            <button id="register-submit" name="register-submit" type="submit"
                class="w-full py-2 mt-2 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 transition">Register</button>
        </form>
    </div>
</main>
<footer class="mt-6 text-xs text-gray-500 dark:text-gray-400 text-center pb-4">
    <a href="/admin" class="hover:text-blue-600 dark:hover:text-blue-400 transition">Login to Admin Dashboard</a>
</footer>
{% endblock %}

{% block scripts %}
<script>
    let activeTab = "{{ active_tab }}";

    const loginTab = document.getElementById("loginTab");
    const registerTab = document.getElementById("registerTab");
    const loginForm = document.getElementById("loginForm");
    const registerForm = document.getElementById("registerForm");
    const toggleDark = document.getElementById("toggleDark");
    const themeIcon = document.getElementById("themeIcon");

    function showLogin() {
        loginForm.classList.remove("hidden");
        registerForm.classList.add("hidden");
        loginForm.classList.add("animate__fadeIn");
        loginTab.classList.add("text-blue-600", "border-blue-600");
        loginTab.classList.remove("text-gray-500", "dark:text-gray-400", "border-transparent");
        registerTab.classList.add("text-gray-500", "dark:text-gray-400", "border-transparent");
        registerTab.classList.remove("text-blue-600", "border-blue-600");
        activeTab = "login";
    }

    function showRegister() {
        registerForm.classList.remove("hidden");
        loginForm.classList.add("hidden");
        registerForm.classList.add("animate__fadeIn");
        registerTab.classList.add("text-blue-600", "border-blue-600");
        registerTab.classList.remove("text-gray-500", "dark:text-gray-400", "border-transparent");
        loginTab.classList.add("text-gray-500", "dark:text-gray-400", "border-transparent");
        loginTab.classList.remove("text-blue-600", "border-blue-600");
        activeTab = "register";
    }

    function toggleTheme() {
        document.documentElement.classList.toggle("dark");
        if (document.documentElement.classList.contains("dark")) {
            themeIcon.classList.replace("fa-moon", "fa-sun");
        } else {
            themeIcon.classList.replace("fa-sun", "fa-moon");
        }
    }

    loginTab.addEventListener("click", showLogin);
    registerTab.addEventListener("click", showRegister);
    toggleDark.addEventListener("click", toggleTheme);

    if (activeTab === "register") {
        showRegister();
    } else {
        showLogin();
    }
</script>

{% endblock %}